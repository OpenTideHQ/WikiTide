#   



> 

| Name                            | Field          | SubField             | SubSubField               | Description                                                                                                                                                                                                                                                                                                                                                                                                                                 | Type                  | Example                                           |
|:--------------------------------|:---------------|:---------------------|:--------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------------|:--------------------------------------------------|
| Schema identifier and version   | `schema`       |                      |                           | Identifier of the schema at its current version                                                                                                                                                                                                                                                                                                                                                                                             | string                |                                                   |
| ‚ôªÔ∏è Status of the use-case       | `status`       |                      |                           | Define the status according to use case development life cycle process                                                                                                                                                                                                                                                                                                                                                                      | string                | STAGING                                           |
| üë• Development Contributors      | `contributors` |                      |                           | Individuals who supported creating, enriching or tuning the detection.                                                                                                                                                                                                                                                                                                                                                                      | array                 |                                                   |
| üè¢ Target Tenants                | `tenants`      |                      |                           | Override the default organizations and deploy to selected tenants only.                                                                                                                                                                                                                                                                                                                                                                     | array                 |                                                   |
| üö© Flags                         | `flags`        |                      |                           | Flags allow to customize the rule behaviour using the modifiers framework                                                                                                                                                                                                                                                                                                                                                                   | array                 |                                                   |
| Alert Trigger                   | `trigger`      |                      |                           | Event trigger configuration                                                                                                                                                                                                                                                                                                                                                                                                                 | object                |                                                   |
| üî´ None                          |                | `operator`           |                           | The operation against the threshold that triggers alert rule.  ‚ö†Ô∏è If you create a NRT rule, this value must be removed or commented out (NRT rules trigger an alert on the first match)                                                                                                                                                                                                                                                     |                       |                                                   |
| ‚öñÔ∏è Event threshold              |                | `threshold`          |                           | If amount of events is higher than threshold (during the timeframe) the alert is triggered.   ‚ö†Ô∏è If you create a NRT rule, this value must be removed or commented out (NRT rules trigger an alert on the first match)                                                                                                                                                                                                                      | integer               | 10                                                |
| ‚è≤ Throttling parameters         | `scheduling`   |                      |                           | Configuration for throttling incoming alerts                                                                                                                                                                                                                                                                                                                                                                                                | object                |                                                   |
| Near Real Time Rule             |                | `nrt`                |                           | NRT rules are hard-coded to run once every minute and capture events ingested in the preceding minute, so as to be able to supply you with information as up-to-the-minute as possible.  ‚ö†Ô∏è You can not turn a ScheduledAlert into a NRT Rule or vice versa. Once the MDR is deployed under this UUID, if it must be transformed into a different type, a new UUID must be attributed and the previous rule manually removed from Sentinel. | boolean               |                                                   |
| ‚è± Recurring Search Interval     |                | `frequency`          |                           | Time intervals at which the scheduled search should be ran at, from 5m to up to 14days. Format is X d|h|m. If you create a NRT rule, this value must be removed or commented out.                                                                                                                                                                                                                                                           | string                | 5m                                                |
| ‚åõ Lookback Configuration        |                | `lookback`           |                           | Duration of logs to search in, up to 14 days. Format is X d|h|m. If you create a NRT rule, this value must be removed or commented out.                                                                                                                                                                                                                                                                                                     | string                | 5m                                                |
| üö® Alert Configuration           | `alert`        |                      |                           | Alert Details allow analytic rules to have dynamic values for the Displayed name, Description, Tactics and Severity properties of the alert. By using dynamic alert details, the same rule can generate different incidents, for example with different severity. Also, the information displayed to the analyst can include variable information such as relevant entity names to  help the analyst understand the incident faster.        | object                |                                                   |
| Create Incident                 |                | `create_incident`    |                           | Create incidents from alerts triggered by this analytics rule                                                                                                                                                                                                                                                                                                                                                                               | boolean               |                                                   |
| Alert Suppression               |                | `suppression`        |                           | The duration to wait since last time this alert rule been triggered. Set to "false" to disable all suppression.                                                                                                                                                                                                                                                                                                                             | ['string', 'boolean'] |                                                   |
| üé´ Alert Display Name Format     |                | `title`              |                           | Free text with field names embedded using the format {{columnName}}. Up to 256 chars and 3 placeholders.                                                                                                                                                                                                                                                                                                                                    | string                | rule {{columnName1}} display name                 |
| üî¨ Alert Description Format      |                | `description`        |                           | Free text with field names embedded using the format {{columnName}}. Up to 5000 chars and 3 placeholders                                                                                                                                                                                                                                                                                                                                    | string                | rule {{columnName1}} display name                 |
| üí£ Alert Severity                |                | `severity`           |                           | Severity the alert will be raised with. Overrides MDR Base Severity                                                                                                                                                                                                                                                                                                                                                                         | string                |                                                   |
| MITRE ATT&CK Tactics            |                | `tactics`            |                           | Mapping of relevant tactics                                                                                                                                                                                                                                                                                                                                                                                                                 | array                 |                                                   |
| MITRE ATT&CK Tactics            |                | `techniques`         |                           | Mapping of relevant tactics - Warning : it's currently not possible to support all valid techniques as a schema for each target system, as they all support different variants and version of ATT&CK. You must check on the GUI what techniques are available and replicate here.                                                                                                                                                           | array                 |                                                   |
| üí¨ Custom Details                |                | `custom_details`     |                           | Surface particular event parameters and their values in alerts that comprise those events, by adding key-value pairs below.                                                                                                                                                                                                                                                                                                                 | array                 |                                                   |
| üóùÔ∏è None                         |                |                      | `key`                     | Enter a name of your choosing that will appear as the field name in alerts.                                                                                                                                                                                                                                                                                                                                                                 | string                |                                                   |
| üíΩ None                          |                |                      | `column`                  | Choose the column which value should be added as a custom detail. Must exist in the result of the query.                                                                                                                                                                                                                                                                                                                                    | string                |                                                   |
| üíΩ Alert Dynamic Properties      |                | `dynamic_properties` |                           | Override alert default properties, select an alert property from the Alert property drop-down list.                                                                                                                                                                                                                                                                                                                                         | array                 |                                                   |
| üóùÔ∏è None                         |                |                      | `property`                | The V3 Alert Property                                                                                                                                                                                                                                                                                                                                                                                                                       | string                |                                                   |
| üíΩ None                          |                |                      | `column`                  | Choose the column which value should override the alert property. Must exist in the result of the query.                                                                                                                                                                                                                                                                                                                                    | string                |                                                   |
| üí† Grouping Setup                | `grouping`     |                      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                             | object                |                                                   |
| üì£ Event Grouping Details        |                | `event`              |                           | Configure how rule query results are grouped into alerts.                                                                                                                                                                                                                                                                                                                                                                                   | string                |                                                   |
| üö® Alert Grouping Details        |                | `alert`              |                           | Set how the alerts that are triggered by this analytics rule, are grouped into incidents. Grouping alerts into incidents provides the context you need to respond and reduces the noise from single alerts.                                                                                                                                                                                                                                 | object                |                                                   |
| üéöÔ∏è Enable Alert Grouping        |                |                      | `enabled`                 |                                                                                                                                                                                                                                                                                                                                                                                                                                             | boolean               |                                                   |
| ‚õ©Ô∏è Re-Open Closed Incidents     |                |                      | `reopen_closed_incidents` | Re-open closed matching incidents                                                                                                                                                                                                                                                                                                                                                                                                           | boolean               |                                                   |
| ‚è≥ Timeframe to Group Alerts     |                |                      | `grouping_lookback`       | Limit the group to alerts created within the selected time frame.                                                                                                                                                                                                                                                                                                                                                                           | string                |                                                   |
| ‚ù§Ô∏è‚Äçüî• Matching Method            |                |                      | `matching`                | Group alerts triggered by this analytics rule into a single incident using defined methods.                                                                                                                                                                                                                                                                                                                                                 | string                |                                                   |
| üßä Entity Alert Grouping         |                |                      | `group_by_entities`       | A list of entity types to group by (when matchingMethod is Selected). Only entities defined in the current alert rule may be used.                                                                                                                                                                                                                                                                                                          | array                 |                                                   |
| üí¨ Alert Details Alert Grouping  |                |                      | `group_by_alert_details`  | A list of alert details to group by (when matchingMethod is Selected)                                                                                                                                                                                                                                                                                                                                                                       | array                 |                                                   |
| üí¨ Custom Details Alert Grouping |                |                      | `group_by_custom_details` | A list of custom details keys to group by (when matchingMethod is Selected). Only keys defined in the current alert rule may be used.                                                                                                                                                                                                                                                                                                       | array                 |                                                   |
| üßä Entity Mappings               | `entities`     |                      |                           | Entity mapping is an integral part of the configuration of scheduled query analytics rules. It enriches the rules' output (alerts and incidents) with essential information that serves as the building blocks of any investigative processes and remedial actions that follow.                                                                                                                                                             | array                 |                                                   |
| üßä Sentinel Entity               |                | `entity`             |                           | Entity Type for which attributes available as identifier are mapped to.                                                                                                                                                                                                                                                                                                                                                                     | string                |                                                   |
| üó∫Ô∏è Entity Mappings              |                | `mappings`           |                           | Identifier and Column combination for the chosen entity type                                                                                                                                                                                                                                                                                                                                                                                | array                 |                                                   |
| üìç Entity Identifier             |                |                      | `identifier`              | Identifier used to provide identification for the chosen entity.                                                                                                                                                                                                                                                                                                                                                                            | string                |                                                   |
| ü™ò Data Table Column             |                |                      | `column`                  | The column name to be mapped to the identifier. Note that it must be a valid column name available in the query result from the KQL chosen.                                                                                                                                                                                                                                                                                                 | string                |                                                   |
| üîé Sentinel KQL Detection Rule   | `query`        |                      |                           | Scheduled query in KQL language                                                                                                                                                                                                                                                                                                                                                                                                             | string                | SignInLogs | evaluate bag_unpack(LocationDetails) |

### Template

``

```yaml
  schema: sentinel::2.1
  status: DEVELOPMENT
  #contributors:
    #-
  #tenants:
    #-
  #flags:
    #-
  
  trigger:
    operator: GreaterThan
    threshold: 0
  
  scheduling:
    #nrt: false
    frequency: 
    lookback: 
  
  alert:
    create_incident: true
    suppression: false
    #title: 
    #description: |
      #...
    #custom_details:
      #- key: 
        #column: 
    #dynamic_properties:
      #- property: 
        #column: 
  
  grouping:
    event: SingleAlert
  
    alert:
      enabled: false
      #reopen_closed_incidents: 
      #grouping_lookback: 
      #matching: AllEntities
  
  #entities:
    #- entity: 
      #mappings:
        #- identifier: 
          #column: 
  
  query: |
    ...
```

