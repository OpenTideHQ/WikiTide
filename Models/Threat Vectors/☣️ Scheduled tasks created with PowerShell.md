

# â˜£ï¸ Scheduled tasks created with PowerShell

ğŸ”¥ **Criticality:Medium** â— : A Medium priority incident may affect public health or safety, national security, economic security, foreign relations, civil liberties, or public confidence. 

ğŸš¦ **TLP:CLEAR** âšª : Recipients can spread this to the world, there is no limit on disclosure.


ğŸ—¡ï¸ **ATT&CK Techniques** [T1053.005 : Scheduled Task/Job: Scheduled Task](https://attack.mitre.org/techniques/T1053/005 'Adversaries may abuse the Windows Task Scheduler to perform task scheduling for initial or recurring execution of malicious code There are multiple wa')



---

`ğŸ”‘ UUID : a5f631c3-6fb0-484f-89e4-c8b2e038db8f` **|** `ğŸ·ï¸ Version : 1` **|** `ğŸ—“ï¸ Creation Date : 2022-12-15` **|** `ğŸ—“ï¸ Last Modification : 2022-12-15` **|** `Sharing Organisation : {'uuid': '56b0a0f0-b0bc-47d9-bb46-02f80ae2065a', 'name': 'EC DIGIT CSOC'}` **|** `ğŸ§± Schema Identifier : tvm::2.0`


## ğŸ‘ï¸ Description

> A threat actor can use PowerShell to create tasks for nefarious purposes. 
> 
> Scripts requires admin rights to create a new scheduled task. The script 
> will run in the context of the user who created the scheduled task.
> 
> Scheduled tasks are typically used to either connect to adversary 
> infrastructure, establish persistence or to execute binaries.
> 



## ğŸ–¥ï¸ Terrain 

 > An adversary has gained control over a Windows endpoint and has  
> privileges to create scheduled tasks using PowerShell.exe
> 

---

## ğŸ•¸ï¸ Relations



### ğŸŒŠ OpenTide Objects
ğŸš« No related OpenTide objects indexed.





---

## Model Data

#### **â›“ï¸ Cyber Kill Chain**

 > Cyber attacks are typically phased progressions towards strategic objectives. The Unified Kill Chains provides insight into the tactics that hackers employ to attain these objectives. This provides a solid basis to develop (or realign) defensive strategies to raise cyber resilience.

 [`âš¡ Execution`](https://www.unifiedkillchain.com/assets/The-Unified-Kill-Chain.pdf) : Techniques that result in execution of attacker-controlled code on a local or remote system.

---

#### **ğŸ›°ï¸ Domains**

 > Infrastructure technologies domain of interest to attackers.

  - `ğŸ¢ Enterprise` : Generic databases, applications, machines and systems that are usually on premises or on Cloud traditional VMs.
 - `â˜ï¸ Public Cloud` : Infrastructure handled by a commercial cloud provider. Managed mostly on a service level, and connected over the internet.

---

#### **ğŸ¯ Targets**

 > Granular delimited technical entities holding a value to the organization, that are targeted by adversaries. They might be also involved in the detection coverage as the target of log collection. Partially inspired by Veris.

  - [`ğŸ–¥ï¸ Workstations`](http://veriscommunity.net/enums.html#section-asset) : Placeholder
 - [`ğŸ–²ï¸ Control Server`](https://collaborate.mitre.org/attackics/index.php/Control_Server) : A device which acts as both a server and controller, that hosts the control software used in communicating with lower-level control devices in an ICS network (e.g. Remote Terminal Units (RTUs) and Programmable Logic Controllers (PLCs)).
 - [`ğŸ–²ï¸ Input/Output Server`](https://collaborate.mitre.org/attackics/index.php/Input/Output_Server) : The Input/Output (I/O) server provides the interface between the control system LAN applications and the field equipment monitored and controlled by the control system applications. The I/O server, sometimes referred to as a Front-End Processor (FEP) or Data Acquisition Server (DAS), converts the control system application data into packets that are transmitted over various types of communications media to the end device locations. The I/O server also converts data received from the various end devices over different communications mediums into data formatted to communicate with the control system networked applications.
 - [`ğŸ’» Laptop`](http://veriscommunity.net/enums.html#section-asset) : User Device - Laptop
 - [`ğŸ–¥ï¸ Desktop`](http://veriscommunity.net/enums.html#section-asset) : User Device - Desktop or workstation
 - [`ğŸ•¹ï¸ Remote access`](http://veriscommunity.net/enums.html#section-asset) : Server - Remote access
 - [`ğŸ–¥ï¸ Web Application Servers`](http://veriscommunity.net/enums.html#section-asset) : Placeholder
 - [`ğŸ–¥ï¸ Public-Facing Servers`](http://veriscommunity.net/enums.html#section-asset) : Placeholder

---

#### **ğŸ’¿ Platforms concerned**

 > Actual technologies used by the organization that will be exploited by adversaries during a successful attack, and eventually of relevance for detection. Are named by commercial designation.

 ` Windows` : Placeholder

---

#### **ğŸ’£ Severity**

 > The severity summarizes the overall danger of incident the vector will provoke, and is to be derived (WIP) from impact, leverage, and difficulty to execute.

 [`ğŸ§¨ Moderate incident`](https://www.ncsc.gov.uk/news/new-cyber-attack-categorisation-system-improve-uk-response-incidents) : A cyber attack on a small organisation, or which poses a considerable risk to a medium-sized organisation, or preliminary indications of cyber activity against a large organisation or the government.

---

#### **ğŸª„ Leverage acquisition**

 > Technical aftermath of the attack from the target perspective, differentiated from impact as it does not consider the value of the consequence, only what increased control the vector execution provides to the adversary.

 [`ğŸ¦  Dwelling`](https://owasp.org/www-community/Threat_Modeling_Process#stride) : Active or passive extended presence in the target, which performs adversarial operations continuously.

---

#### **ğŸ’¥ Impact**

 > Analysis of the threat vector from the organizational perspective, in non technical term. This aims at putting a clear denomination on what the attacker will actually be able to act upon if the threat vector is realized.

 [`ğŸ©¼ Impairement`](http://veriscommunity.net/enums.html#section-impact) : Incapacitation of a particular key system that will cause disruptions in day-to-day operations, and eventually service delivery.

---

#### **ğŸ² Vector Viability**

 > Described with estimative language (likelyhood probability), describes how likely the analyst believes the vector to actually be realized on the organization infrastructure. Estimative language describes quality and credibility of underlying sources, data, and methodologies based Intelligence Community Directive 203 (ICD 203) and JP 2-0, Joint Intelligence.

 [`ğŸ§ Likely`](https://www.dni.gov/files/documents/ICD/ICD%20203%20Analytic%20Standards.pdf) : Probable (probably) - 55-80%

---



### ğŸ”— References



**ğŸ•Šï¸ Publicly available resources**

- [_1_] https://devblogs.microsoft.com/scripting/use-powershell-to-create-scheduled-tasks/
- [_2_] https://attack.mitre.org/techniques/T1053/005/
- [_3_] https://learn.microsoft.com/en-us/windows/win32/taskschd/about-the-task-scheduler
- [_4_] https://www.microsoft.com/en-us/security/blog/2022/04/12/tarrask-malware-uses-scheduled-tasks-for-defense-evasion/
- [_5_] https://redcanary.com/threat-detection-report/techniques/powershell/

[1]: https://devblogs.microsoft.com/scripting/use-powershell-to-create-scheduled-tasks/
[2]: https://attack.mitre.org/techniques/T1053/005/
[3]: https://learn.microsoft.com/en-us/windows/win32/taskschd/about-the-task-scheduler
[4]: https://www.microsoft.com/en-us/security/blog/2022/04/12/tarrask-malware-uses-scheduled-tasks-for-defense-evasion/
[5]: https://redcanary.com/threat-detection-report/techniques/powershell/

---

#### ğŸ·ï¸ Tags

#-, #-, #-, #
, #
, ##, ##, ##, ##, # , #ğŸ·, #ï¸, # , #T, #a, #g, #s, #
, #


